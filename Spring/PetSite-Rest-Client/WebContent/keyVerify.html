<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Insert title here</title>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
</head>

<body>
    <h1>이메일 인증키 인증하기</h1>
    <input type="button" onclick="getParams()" value="인증하기">
    <span id="span"></span>
    <!--<input type="hidden" id="code" value="">
<input type="hidden" id="id" value="">-->

    <script>
        $(document).ready(function() {

        });

        function getParams() {
            // 현재 페이지의 url
            var url = decodeURIComponent(location.href);
            // url이 encodeURIComponent로 인코딩 되었을 때 다시 디코딩
            url = decodeURIComponent(url);

            var params;
            // url에서 '?' 문자 이후의 파라미터 문자열까지 자르기
            params = url.substring(url.indexOf('?') + 1, url.length);
            // 파라미터 구분자("&")로 분리
            params = params.split("&");
            alert('params: ' + params);
            // ("=")로 분리해서 값 받아오기
            var code = params[0].split("=")[1];
            var id = params[1].split("=")[1];

            alert('code: ' + code);
            alert('id: ' + id);

            /*$('#code').val(code);
            $('#id').val(id);*/

            $.ajax({
                url: 'http://localhost:9090/ps/members/verify',
                type: 'GET',
                data: {
                    code: code,
                    id: id
                },
                success: function(data) {
                    if (data == 'success') {
                        $('#span').html("인증 성공!");
                        $('#span').css('color', 'green');
                    } else {
                        $('#span').html("인증 실패ㅠㅜ");
                        $('#span').css('color', 'red');
                    }
                }
            });
        }
    </script>
</body></html>